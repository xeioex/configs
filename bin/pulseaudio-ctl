#!/bin/bash
 
DEFAULT_SINK_NAME="alsa_output.usb-ESI_Audiotechnik_GmbH_Dr._DAC_nano-01-nano.analog-stereo"

DEFAULT_SINK_INDEX=$(pacmd list-sinks | grep -B 1 $DEFAULT_SINK_NAME | awk '/.*index: ([0-9]+)/{print $3}')
DEFAULT_SINK_MUTE_STATE=$(pacmd dump | grep 'set-sink-mute' | grep $DEFAULT_SINK_NAME | cut -d' ' -f 3)
DEFAULT_SINK_VOLUME=$(pacmd list-sinks | grep -A 10 $DEFAULT_SINK_NAME | grep volume -m1 | egrep -o '[0-9]+%' | egrep -m1 -o '[0-9]+')

CURRENT_SINK_NAME=$(pacmd dump | perl -a -n -e 'print $F[1] if /set-default-sink/')

if [ $CURRENT_SINK_NAME != $DEFAULT_SINK_NAME ]; then
    pacmd set-default-sink  $DEFAULT_SINK_NAME
fi
 
function plus() {
        pactl set-sink-volume $DEFAULT_SINK_INDEX +5%
}
 
function minus() {
        pactl set-sink-volume $DEFAULT_SINK_INDEX -- -5%
}
 
function mutetoggle() {
        if [ $DEFAULT_SINK_MUTE_STATE = no ]; then
                pactl set-sink-mute $DEFAULT_SINK_NAME 1
        elif [ $DEFAULT_SINK_MUTE_STATE = yes ]; then
                pactl set-sink-mute $DEFAULT_SINK_NAME 0
        fi
}

function mutestatus() {
        if [ $DEFAULT_SINK_MUTE_STATE = yes ]; then
                echo MUTED
        fi
}
 
case "$1" in
        plus)
                plus
        ;;
        minus)
                minus
        ;;
        mutetoggle)
                mutetoggle
        ;;
        mutestatus)
                mutestatus
        ;;
        volume)
                echo $DEFAULT_SINK_VOLUME
        ;;
        *)
            echo "Unknown command: $1"
            exit 1
esac
